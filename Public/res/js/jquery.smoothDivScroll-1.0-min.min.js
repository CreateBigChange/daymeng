(function(a){a.widget("thomaskahn.smoothDivScroll",{options:{scrollingHotSpotLeft:"div.scrollingHotSpotLeft",scrollingHotSpotRight:"div.scrollingHotSpotRight",scrollableArea:"div.scrollableArea",scrollWrapper:"div.scrollWrapper",hiddenOnStart:false,ajaxContentURL:"",countOnlyClass:"",scrollStep:15,scrollInterval:10,mouseDownSpeedBooster:3,autoScroll:"",autoScrollDirection:"right",autoScrollStep:5,autoScrollInterval:10,visibleHotSpots:"",hotSpotsVisibleTime:5,startAtElementId:""},_create:function(){var d=this,c=this.options,b=this.element;b.data("scrollWrapper",b.find(c.scrollWrapper));b.data("scrollingHotSpotRight",b.find(c.scrollingHotSpotRight));b.data("scrollingHotSpotLeft",b.find(c.scrollingHotSpotLeft));b.data("scrollableArea",b.find(c.scrollableArea));b.data("speedBooster",1);b.data("motherElementOffset",b.offset().left);b.data("scrollXPos",0);b.data("hotSpotWidth",b.find(c.scrollingHotSpotLeft).width());b.data("scrollableAreaWidth",0);b.data("startingPosition",0);b.data("rightScrollInterval",null);b.data("leftScrollInterval",null);b.data("autoScrollInterval",null);b.data("hideHotSpotBackgroundsInterval",null);b.data("previousScrollLeft",0);b.data("pingPongDirection","right");b.data("getNextElementWidth",true);b.data("swapAt",null);b.data("startAtElementHasNotPassed",true);b.data("swappedElement",null);b.data("originalElements",b.data("scrollableArea").children(c.countOnlyClass));b.data("visible",true);d.recalculateScrollableArea();b.data("scrollWrapper").scrollLeft(b.data("startingPosition"));if(c.autoScroll!=="always"){switch(c.visibleHotSpots){case"always":d.showHotSpotBackgrounds();break;case"onstart":d.showHotSpotBackgrounds();b.data("hideHotSpotBackgroundsInterval",setTimeout(function(){d.hideHotSpotBackgrounds("slow")},(c.hotSpotsVisibleTime*1000)));break;default:break}}b.data("scrollingHotSpotRight").bind("mousemove",function(f){var g=f.pageX-(this.offsetLeft+b.data("motherElementOffset"));b.data("scrollXPos",Math.round((g/b.data("hotSpotWidth"))*c.scrollStep));if(b.data("scrollXPos")===Infinity){b.data("scrollXPos",0)}});b.data("scrollingHotSpotRight").bind("mouseover",function(){if((c.autoScroll==="onstart"&&b.data("autoScrollInterval")!==null)){clearInterval(b.data("autoScrollInterval"));b.data("autoScrollInterval",null);d._trigger("autoScrollIntervalStopped")}b.data("rightScrollInterval",setInterval(function(){if(b.data("scrollXPos")>0){b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()+(b.data("scrollXPos")*b.data("speedBooster")));d._showHideHotSpots()}},c.scrollInterval));d._trigger("mouseOverRightHotSpot")});b.data("scrollingHotSpotRight").bind("mouseout",function(){clearInterval(b.data("rightScrollInterval"));b.data("scrollXPos",0)});b.data("scrollingHotSpotRight").bind("mousedown",function(){b.data("speedBooster",c.mouseDownSpeedBooster)});a("body").bind("mouseup",function(){b.data("speedBooster",1)});b.data("scrollingHotSpotLeft").bind("mousemove",function(f){var g=b.data("scrollingHotSpotLeft").innerWidth()-(f.pageX-b.data("motherElementOffset"));b.data("scrollXPos",Math.round((g/b.data("hotSpotWidth"))*c.scrollStep));if(b.data("scrollXPos")===Infinity){b.data("scrollXPos",0)}});b.data("scrollingHotSpotLeft").bind("mouseover",function(){if((c.autoScroll==="onstart"&&b.data("autoScrollInterval")!==null)){clearInterval(b.data("autoScrollInterval"));b.data("autoScrollInterval",null);d._trigger("autoScrollIntervalStopped")}b.data("leftScrollInterval",setInterval(function(){if(b.data("scrollXPos")>0){b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()-(b.data("scrollXPos")*b.data("speedBooster")));d._showHideHotSpots()}},c.scrollInterval));d._trigger("mouseOverLeftHotSpot")});b.data("scrollingHotSpotLeft").bind("mouseout",function(){clearInterval(b.data("leftScrollInterval"));b.data("scrollXPos",0)});b.data("scrollingHotSpotLeft").bind("mousedown",function(){b.data("speedBooster",c.mouseDownSpeedBooster)});a(window).bind("resize",function(){if(!(c.hiddenOnStart)){d._showHideHotSpots()}d._trigger("windowResized")});if(c.autoScroll!==""&&!(c.hiddenOnStart)){d.startAutoScroll()}if(c.hiddenOnStart){d.hide()}},showHotSpotBackgrounds:function(c){var d=this,b=this.element;if(c!==undefined){b.data("scrollingHotSpotLeft").css("opacity","0.0");b.data("scrollingHotSpotRight").css("opacity","0.0");b.data("scrollingHotSpotLeft").addClass("scrollingHotSpotLeftVisible");b.data("scrollingHotSpotRight").addClass("scrollingHotSpotRightVisible");b.data("scrollingHotSpotLeft").fadeTo(c,0.35);b.data("scrollingHotSpotRight").fadeTo(c,0.35)}else{b.data("scrollingHotSpotLeft").addClass("scrollingHotSpotLeftVisible");b.data("scrollingHotSpotLeft").removeAttr("style");b.data("scrollingHotSpotRight").addClass("scrollingHotSpotRightVisible");b.data("scrollingHotSpotRight").removeAttr("style")}d._showHideHotSpots()},hideHotSpotBackgrounds:function(c){var b=this.element;if(c!==undefined){b.data("scrollingHotSpotLeft").fadeTo(c,0,function(){b.data("scrollingHotSpotLeft").removeClass("scrollingHotSpotLeftVisible")});b.data("scrollingHotSpotRight").fadeTo(c,0,function(){b.data("scrollingHotSpotRight").removeClass("scrollingHotSpotRightVisible")})}else{b.data("scrollingHotSpotLeft").removeClass("scrollingHotSpotLeftVisible");b.data("scrollingHotSpotLeft").removeAttr("style");b.data("scrollingHotSpotRight").removeClass("scrollingHotSpotRightVisible");b.data("scrollingHotSpotRight").removeAttr("style")}},_showHideHotSpots:function(){var d=this,b=this.element,c=this.options;if(c.autoScroll!=="always"){if(b.data("scrollableAreaWidth")<=(b.data("scrollWrapper").innerWidth())){b.data("scrollingHotSpotLeft").hide();b.data("scrollingHotSpotRight").hide()}else{if(b.data("scrollWrapper").scrollLeft()===0){b.data("scrollingHotSpotLeft").hide();b.data("scrollingHotSpotRight").show();d._trigger("scrollLeftLimitReached");clearInterval(b.data("leftScrollInterval"));b.data("leftScrollInterval",null)}else{if(b.data("scrollableAreaWidth")<=(b.data("scrollWrapper").innerWidth()+b.data("scrollWrapper").scrollLeft())){b.data("scrollingHotSpotLeft").show();b.data("scrollingHotSpotRight").hide();d._trigger("scrollRightLimitReached");clearInterval(b.data("rightScrollInterval"));b.data("rightScrollInterval",null)}else{b.data("scrollingHotSpotLeft").show();b.data("scrollingHotSpotRight").show()}}}}else{b.data("scrollingHotSpotLeft").hide();b.data("scrollingHotSpotRight").hide()}},moveToElement:function(e,c){var g=this,b=this.element,f=this.options,h=0,d=false;switch(e){case"first":b.data("scrollXPos",0);g._trigger("movedToFirstElement");break;case"start":b.data("scrollableArea").children(f.countOnlyClass).each(function(){if((f.startAtElementId.length!==0)&&((a(this).attr("id"))===f.startAtElementId)){b.data("startingPosition",h);d=true}h=h+a(this).outerWidth(true)});b.data("scrollXPos",b.data("startingPosition"));g._trigger("movedToStartElement");break;case"last":b.data("scrollXPos",b.data("scrollableAreaWidth"));g._trigger("movedToLastElement");break;case"number":if(!(isNaN(c))){b.data("scrollableArea").children(f.countOnlyClass).each(function(i){if(i===(c-1)){b.data("scrollXPos",h)}h=h+a(this).outerWidth(true)})}g._trigger("movedToElementNumber",null,{elementNumber:c});break;default:break}b.data("scrollWrapper").scrollLeft(b.data("scrollXPos"));g._showHideHotSpots()},addContent:function(c,b){var e=this,d=this.element;a.get(c,function(f){if(b==="first"){d.data("scrollableArea").children(":first").before(f)}else{d.data("scrollableArea").children(":last").after(f)}e.recalculateScrollableArea();e._showHideHotSpots()})},replaceContent:function(b){var d=this,c=this.element;c.data("scrollableArea").load(b,function(){d.recalculateScrollableArea();d.moveToElement("first");d._showHideHotSpots();c.data("startingPosition",0)})},recalculateScrollableArea:function(){var e=0,c=false,d=this.options,b=this.element;b.data("scrollableArea").children(d.countOnlyClass).each(function(){if((d.startAtElementId.length!==0)&&((a(this).attr("id"))===d.startAtElementId)){b.data("startingPosition",e);c=true}e=e+a(this).outerWidth(true)});if(!(c)){b.data("startAtElementId","")}b.data("scrollableAreaWidth",e);b.data("scrollableArea").width(b.data("scrollableAreaWidth"))},stopAutoScroll:function(){var c=this,b=this.element;clearInterval(b.data("autoScrollInterval"));b.data("autoScrollInterval",null);c._showHideHotSpots();c._trigger("autoScrollStopped")},startAutoScroll:function(){var d=this,b=this.element,c=this.options;d._showHideHotSpots();clearInterval(b.data("autoScrollInterval"));b.data("autoScrollInterval",null);d._trigger("autoScrollStarted");b.data("autoScrollInterval",setInterval(function(){if(!(b.data("visible"))||(b.data("scrollableAreaWidth")<=(b.data("scrollWrapper").innerWidth()))){clearInterval(b.data("autoScrollInterval"));b.data("autoScrollInterval",null)}b.data("previousScrollLeft",b.data("scrollWrapper").scrollLeft());switch(c.autoScrollDirection){case"right":b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()+c.autoScrollStep);if(b.data("previousScrollLeft")===b.data("scrollWrapper").scrollLeft()){d._trigger("autoScrollRightLimitReached");clearInterval(b.data("autoScrollInterval"));b.data("autoScrollInterval",null);d._trigger("autoScrollIntervalStopped")}break;case"left":b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()-c.autoScrollStep);if(b.data("previousScrollLeft")===b.data("scrollWrapper").scrollLeft()){d._trigger("autoScrollLeftLimitReached");clearInterval(b.data("autoScrollInterval"));b.data("autoScrollInterval",null);d._trigger("autoScrollIntervalStopped")}break;case"backandforth":if(b.data("pingPongDirection")==="right"){b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()+(c.autoScrollStep))}else{b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()-(c.autoScrollStep))}if(b.data("previousScrollLeft")===b.data("scrollWrapper").scrollLeft()){if(b.data("pingPongDirection")==="right"){b.data("pingPongDirection","left");d._trigger("autoScrollRightLimitReached")}else{b.data("pingPongDirection","right");d._trigger("autoScrollLeftLimitReached")}}break;case"endlessloopright":if(b.data("getNextElementWidth")){if((c.startAtElementId!=="")&&(b.data("startAtElementHasNotPassed"))){b.data("swapAt",a("#"+c.startAtElementId).outerWidth(true));b.data("startAtElementHasNotPassed",false)}else{b.data("swapAt",b.data("scrollableArea").children(":first").outerWidth(true))}b.data("getNextElementWidth",false)}b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()+c.autoScrollStep);if(b.data("swapAt")<=b.data("scrollWrapper").scrollLeft()){b.data("swappedElement",b.data("scrollableArea").children(":first").detach());b.data("scrollableArea").append(b.data("swappedElement"));b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()-b.data("swappedElement").outerWidth(true));b.data("getNextElementWidth",true)}break;case"endlessloopleft":if(b.data("getNextElementWidth")){if((c.startAtElementId!=="")&&(b.data("startAtElementHasNotPassed"))){b.data("swapAt",a("#"+c.startAtElementId).outerWidth(true));b.data("startAtElementHasNotPassed",false)}else{b.data("swapAt",b.data("scrollableArea").children(":first").outerWidth(true))}b.data("getNextElementWidth",false)}b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()-c.autoScrollStep);if(b.data("scrollWrapper").scrollLeft()===0){b.data("swappedElement",b.data("scrollableArea").children(":last").detach());b.data("scrollableArea").prepend(b.data("swappedElement"));b.data("scrollWrapper").scrollLeft(b.data("scrollWrapper").scrollLeft()+b.data("swappedElement").outerWidth(true));b.data("getNextElementWidth",true)}break;default:break}},c.autoScrollInterval))},restoreOriginalElements:function(){var c=this,b=this.element;b.data("scrollableArea").html(b.data("originalElements"));c.recalculateScrollableArea();c.moveToElement("first")},show:function(){var b=this.element;b.data("visible",true);b.show()},hide:function(){var b=this.element;b.data("visible",false);b.hide()},destroy:function(){var b=this.element;clearInterval(b.data("autoScrollInterval"));clearInterval(b.data("rightScrollInterval"));clearInterval(b.data("leftScrollInterval"));clearInterval(b.data("hideHotSpotBackgroundsInterval"));b.data("scrollingHotSpotRight").unbind("mouseover");b.data("scrollingHotSpotRight").unbind("mouseout");b.data("scrollingHotSpotRight").unbind("mousedown");b.data("scrollingHotSpotLeft").unbind("mouseover");b.data("scrollingHotSpotLeft").unbind("mouseout");b.data("scrollingHotSpotLeft").unbind("mousedown");b.data("scrollableArea").html(b.data("originalElements"));b.data("scrollableArea").removeAttr("style");b.data("scrollingHotSpotRight").removeAttr("style");b.data("scrollingHotSpotLeft").removeAttr("style");b.data("scrollWrapper").scrollLeft(0);b.data("scrollingHotSpotLeft").removeClass("scrollingHotSpotLeftVisible");b.data("scrollingHotSpotRight").removeClass("scrollingHotSpotRightVisible");b.data("scrollingHotSpotRight").hide();b.data("scrollingHotSpotLeft").hide();a.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);